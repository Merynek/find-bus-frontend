import {bbox, points} from "@turf/turf";
import {LngLatBounds} from "mapbox-gl";
import {GeoPoint} from "@/src/data/geoPoint";
import {Country} from "@/src/api/openapi";
const bboxes: {[key: string]: number[]} = {"AD":[42.4288238,1.4135781,42.6559357,1.7863837],"AE":[22.6444,51.498,26.2822,56.3834],"AF":[29.3772,60.5176034,38.4910682,74.889862],"AG":[16.7573901,-62.5536517,17.929,-61.447857],"AI":[18.0615454,-63.6391992,18.7951194,-62.7125449],"AL":[39.6448625,19.1246095,42.6610848,21.0574335],"AM":[38.8404775,43.4471395,41.300712,46.6333087],"AO":[-18.038945,11.4609793,-4.3880634,24.0878856],"AR":[-55.1850761,-73.5600329,-21.781168,-53.6374515],"AS":[-14.7608358,-171.2951296,-10.8449746,-167.9322899],"AT":[46.3722761,9.5307487,49.0205305,17.160776],"AQ":[-85.0511287,-180,-60,180],"AU":[-55.3228175,72.2460938,-9.0882278,168.2249543],"AW":[12.1702998,-70.2809842,12.8102998,-69.6409842],"AX":[59.4541578,19.0832098,60.87665,21.3456556],"AZ":[38.3929551,44.7633701,41.9502947,51.0090302],"BA":[42.5553114,15.7287433,45.2764135,19.6237311],"BB":[12.845,-59.8562115,13.535,-59.2147175],"BD":[20.3756582,88.0075306,26.6382534,92.6804979],"BE":[49.4969821,2.3889137,51.5516667,6.408097],"BF":[9.4104718,-5.5132416,15.084,2.4089717],"BG":[41.2353929,22.3571459,44.2167064,28.8875409],"BH":[25.535,50.2697989,26.6872444,50.9233693],"BI":[-4.4693155,29.0007401,-2.3096796,30.8498462],"BJ":[6.0398696,0.776667,12.4092447,3.843343],"BL":[17.867995,-62.878704,17.944604,-62.776909],"BM":[32.0469651,-65.1232222,32.5913693,-64.4109842],"BN":[4.002508,114.0758734,5.1011857,115.3635623],"BO":[-22.8982742,-69.6450073,-9.6689438,-57.453],"BQ":[12.005741,-68.440704,12.333294,-68.161926],"BR":[-33.8689056,-73.9830625,5.2842873,-28.6341164],"BS":[20.7059846,-80.7001941,27.4734551,-72.4477521],"BT":[26.702016,88.7464724,28.246987,92.1252321],"BV":[-54.654,2.9345531,-54.187,3.7791099],"BW":[-26.9059669,19.9986474,-17.778137,29.375304],"BY":[51.2575982,23.1783344,56.17218,32.7627809],"BZ":[15.8857286,-89.2262083,18.496001,-87.3098494],"CA":[41.6765556,-141.00275,83.3362128,-52.3231981],"CC":[-12.4055983,96.612524,-11.6213132,97.1357343],"CD":[-13.459035,12.039074,5.3920026,31.3056758],"CF":[2.2156553,14.4155426,11.001389,27.4540764],"CG":[-5.149089,11.0048205,3.713056,18.643611],"CI":[4.1621205,-8.601725,10.740197,-2.493031],"CK":[-22.15807,-166.0856468,-8.7168792,-157.1089329],"CL":[-56.725,-109.6795789,-17.4983998,-66.0753474],"CM":[1.6546659,8.3822176,13.083333,16.1921476],"CN":[8.8383436,73.4997347,53.5608154,134.7754563],"CO":[-4.2316872,-82.1243666,16.0571269,-66.8511907],"CR":[5.3329698,-87.2722647,11.2195684,-82.5060208],"CU":[19.6275294,-85.1679702,23.4816972,-73.9190004],"CV":[14.8031546,-25.3609478,17.2053108,-22.6673416],"CW":[11.978875,-69.175415,12.405730,-68.637772],"CX":[-10.5698515,105.5336422,-10.4123553,105.7130159],"CY":[34.4383706,32.0227581,35.913252,34.8553182],"CZ":[48.5518083,12.0905901,51.0557036,18.859216],"DE":[47.2701114,5.8663153,55.099161,15.0419319],"DJ":[10.9149547,41.7713139,12.7923081,43.6579046],"DK":[54.4516667,7.7153255,57.9524297,15.5530641],"DM":[15.0074207,-61.6869184,15.7872222,-61.0329895],"DO":[17.2701708,-72.0574706,21.303433,-68.1101463],"DZ":[18.968147,-8.668908,37.2962055,11.997337],"EC":[-5.0159314,-92.2072392,1.8835964,-75.192504],"EE":[57.5092997,21.3826069,59.9383754,28.2100175],"EG":[22,24.6499112,31.8330854,37.1153517],"EH":[20.556883,-17.3494721,27.6666834,-8.666389],"ER":[12.3548219,36.4333653,18.0709917,43.3001714],"ES":[27.4335426,-18.3936845,43.9933088,4.5918885],"ET":[3.397448,32.9975838,14.8940537,47.9823797],"FI":[59.4541578,19.0832098,70.0922939,31.5867071],"FJ":[-21.9434274,172,-12.2613866,-178.5],"FK":[-53.1186766,-61.7726772,-50.7973007,-57.3662367],"FM":[0.827,137.2234512,10.291,163.2364054],"FO":[61.3915553,-7.6882939,62.3942991,-6.2565525],"FR":[41.2632185,-5.4534286,51.268318,9.8678344],"GA":[-4.1012261,8.5002246,2.3182171,14.539444],"GB":[49.674,-14.015517,61.061,2.0919117],"GD":[11.786,-62.0065868,12.5966532,-61.1732143],"GE":[41.0552922,39.8844803,43.5864294,46.7365373],"GF":[2.112222,-54.60278,5.7507111,-51.6346139],"GG":[49.4155331,-2.6751703,49.5090776,-2.501814],"GH":[4.5392525,-3.260786,11.1748562,1.2732942],"GI":[36.100807,-5.3941295,36.180807,-5.3141295],"GL":[59.515387,-74.1250416,83.875172,-10.0288759],"GM":[13.061,-17.0288254,13.8253137,-13.797778],"GN":[7.1906045,-15.5680508,12.67563,-7.6381993],"GP":[15.8320085,-61.809764,16.5144664,-61.0003663],"GQ":[-1.6732196,5.4172943,3.989,11.3598628],"GR":[34.7006096,19.2477876,41.7488862,29.7296986],"GS":[-59.684,-42.354739,-53.3500755,-25.8468303],"GT":[13.6345804,-92.3105242,17.8165947,-88.1755849],"GU":[13.182335,144.563426,13.706179,145.009167],"GW":[10.6514215,-16.894523,12.6862384,-13.6348777],"GY":[1.1710017,-61.414905,8.6038842,-56.4689543],"HK":[22.1193278,114.0028131,22.4393278,114.3228131],"HM":[-53.394741,72.2460938,-52.7030677,74.1988754],"HN":[12.9808485,-89.3568207,17.619526,-82.1729621],"HR":[42.1765993,13.2104814,46.555029,19.4470842],"HT":[17.9099291,-75.2384618,20.2181368,-71.6217461],"HU":[45.737128,16.1138867,48.585257,22.8977094],"CH":[45.817995,5.9559113,47.8084648,10.4922941],"ID":[-11.2085669,94.7717124,6.2744496,141.0194444],"IE":[51.222,-11.0133788,55.636,-5.6582363],"IL":[29.4533796,34.2674994,33.3356317,35.8950234],"IM":[54.0539576,-4.7946845,54.4178705,-4.3076853],"IN":[6.5546079,68.1113787,35.6745457,97.395561],"IO":[-7.6454079,71.036504,-5.037066,72.7020157],"IQ":[29.0585661,38.7936719,37.380932,48.8412702],"IR":[24.8465103,44.0318908,39.7816502,63.3332704],"IS":[63.0859177,-25.0135069,67.353,-12.8046162],"IT":[35.2889616,6.6272658,47.0921462,18.7844746],"JE":[49.1625179,-2.254512,49.2621288,-2.0104193],"JM":[16.5899443,-78.5782366,18.7256394,-75.7541143],"JO":[29.183401,34.8844372,33.3750617,39.3012981],"JP":[20.2145811,122.7141754,45.7112046,154.205541],"KE":[-4.8995204,33.9098987,4.62,41.899578],"KG":[39.1728437,69.2649523,43.2667971,80.2295793],"KH":[9.4752639,102.3338282,14.6904224,107.6276788],"KI":[-7.0516717,-179.1645388,7.9483283,-164.1645388],"KM":[-12.621,43.025305,-11.165,44.7451922],"KN":[16.895,-63.051129,17.6158146,-62.3303519],"KP":[37.5867855,124.0913902,43.0089642,130.924647],"KR":[32.9104556,124.354847,38.623477,132.1467806],"KW":[28.5243622,46.5526837,30.1038082,49.0046809],"KY":[19.0620619,-81.6313748,19.9573759,-79.5110954],"KZ":[40.5686476,46.4932179,55.4421701,87.3156316],"LA":[13.9096752,100.0843247,22.5086717,107.6349989],"LB":[33.0479858,34.8825667,34.6923543,36.625],"LC":[13.508,-61.2853867,14.2725,-60.6669363],"LI":[47.0484291,9.4716736,47.270581,9.6357143],"LK":[5.719,79.3959205,10.035,82.0810141],"LR":[4.1555907,-11.6080764,8.5519861,-7.367323],"LS":[-30.6772773,27.0114632,-28.570615,29.4557099],"LT":[53.8967893,20.653783,56.4504213,26.8355198],"LU":[49.4969821,4.9684415,50.430377,6.0344254],"LV":[55.6746505,20.6715407,58.0855688,28.2414904],"LY":[19.5008138,9.391081,33.3545898,25.3770629],"MA":[21.3365321,-17.2551456,36.0505269,-0.998429],"MC":[43.7247599,7.4090279,43.7519311,7.4398704],"MD":[45.4674139,26.6162189,48.4918695,30.1636756],"ME":[41.7495999,18.4195781,43.5585061,20.3561641],"MF":[18.004529,-63.155594,18.124155,-63.007793],"MG":[-25.6071002,43.2202072,-11.9519693,50.4862553],"MH":[-0.5481258,163.4985095,14.4518742,178.4985095],"MK":[40.8536596,20.4529023,42.3735359,23.034051],"ML":[10.147811,-12.2402835,25.001084,4.2673828],"MM":[9.4399432,92.1719423,28.547835,101.1700796],"MN":[41.5800276,87.73762,52.1496,119.931949],"MO":[22.0766667,113.5281666,22.2170361,113.6301389],"MP":[14.036565,144.813338,20.616556,146.154418],"MQ":[14.3948596,-61.2290815,14.8787029,-60.8095833],"MR":[14.7209909,-17.068081,27.314942,-4.8333344],"MS":[16.475,-62.450667,17.0152978,-61.9353818],"MT":[35.6029696,13.9324226,36.2852706,14.8267966],"MU":[-20.725,56.3825151,-10.138,63.7151319],"MV":[-0.9074935,72.3554187,7.3106246,73.9700962],"MW":[-17.1296031,32.6703616,-9.3683261,35.9185731],"MX":[14.3886243,-118.59919,32.7186553,-86.493266],"MY":[-5.1076241,105.3471939,9.8923759,120.3471939],"MZ":[-26.9209427,30.2138197,-10.3252149,41.0545908],"NA":[-28.96945,11.5280384,-16.9634855,25.2617671],"NC":[-23.2217509,162.6034343,-17.6868616,167.8109827],"NE":[11.693756,0.1689653,23.517178,15.996667],"NF":[-29.333,167.6873878,-28.796,168.2249543],"NG":[4.0690959,2.676932,13.885645,14.678014],"NI":[10.7076565,-87.901532,15.0331183,-82.6227023],"NL":[50.7295671,1.9193492,53.7253321,7.2274985],"NO":[57.7590052,4.0875274,71.3848787,31.7614911],"NP":[26.3477581,80.0586226,30.446945,88.2015257],"NR":[-0.5541334,166.9091794,-0.5025906,166.9589235],"NU":[-19.3548665,-170.1595029,-18.7534559,-169.5647229],"NZ":[-52.8213687,-179.059153,-29.0303303,179.3643594],"OM":[16.4649608,52,26.7026737,60.054577],"PA":[7.0338679,-83.0517245,9.8701757,-77.1393779],"PE":[-20.1984472,-84.6356535,-0.0392818,-68.6519906],"PF":[-28.0990232,-154.9360599,-7.6592173,-134.244799],"PG":[-13.1816069,136.7489081,1.8183931,151.7489081],"PH":[4.2158064,114.0952145,21.3217806,126.8072562],"PK":[23.5393916,60.872855,37.084107,77.1203914],"PL":[49.0020468,14.1229707,55.0336963,24.145783],"PM":[46.5507173,-56.6972961,47.365,-55.9033333],"PN":[-25.1306736,-130.8049862,-23.8655769,-124.717534],"PR":[17.9268695,-67.271492,18.5159789,-65.5897525],"PS":[31.2201289,34.0689732,32.5521479,35.5739235],"PT":[29.8288021,-31.5575303,42.1543112,-6.1891593],"PW":[2.748,131.0685462,8.222,134.7714735],"PY":[-27.6063935,-62.6442036,-19.2876472,-54.258],"QA":[24.4707534,50.5675,26.3830212,52.638011],"RE":[-21.3897308,55.2164268,-20.8717136,55.8366924],"RO":[43.618682,20.2619773,48.2653964,30.0454257],"RS":[42.2322435,18.8142875,46.1900524,23.006309],"RU":[41.1850968,19.6389,82.0586232,180],"RW":[-2.8389804,28.8617546,-1.0474083,30.8990738],"SA":[16.29,34.4571718,32.1543377,55.6666851],"SB":[-13.2424298,155.3190556,-4.81085,170.3964667],"SC":[-10.4649258,45.9988759,-3.512,56.4979396],"SD":[8.685278,21.8145046,22.224918,39.0576252],"SE":[55.1331192,10.5930952,69.0599699,24.1776819],"SG":[1.1304753,103.6920359,1.4504753,104.0120359],"SH":[-16.23,-5.9973424,-15.704,-5.4234153],"SI":[45.4214242,13.3754696,46.8766816,16.5967702],"SJ":[70.6260825,-9.6848146,81.028076,34.6891253],"SK":[47.7314286,16.8331891,49.6138162,22.56571],"SL":[6.755,-13.5003389,9.999973,-10.271683],"SM":[43.8937002,12.4033246,43.992093,12.5160665],"SN":[12.2372838,-17.7862419,16.6919712,-11.3458996],"SO":[-1.8031969,40.98918,12.1889121,51.6177696],"SR":[1.8312802,-58.070833,6.225,-53.8433358],"SS":[3.447625,23.631592,12.318536,35.364990],"ST":[-0.2135137,6.260642,1.9257601,7.6704783],"SV":[12.976046,-90.1790975,14.4510488,-87.6351394],"SX":[18.003060,-63.131046,18.059375,-63.007278],"SY":[32.311354,35.4714427,37.3184589,42.3745687],"SZ":[-27.3175201,30.7908,-25.71876,32.1349923],"TC":[20.9553418,-72.6799046,22.1630989,-70.8643591],"TD":[7.44107,13.47348,23.4975,24],"TF":[-50.2187169,39.4138676,-11.3139928,77.8494974],"TG":[5.926547,-0.1439746,11.1395102,1.8087605],"TH":[5.612851,97.3438072,20.4648337,105.636812],"TJ":[36.6711153,67.3332775,41.0450935,75.1539563],"TK":[-9.6442499,-172.7213673,-8.3328631,-170.9797586],"TL":[-9.5642775,124.0415703,-8.0895459,127.5335392],"TM":[35.129093,52.335076,42.7975571,66.6895177],"TN":[30.230236,7.5219807,37.7612052,11.8801133],"TO":[-24.1034499,-179.3866055,-15.3655722,-173.5295458],"TR":[35.8076804,25.6212891,42.297,44.8176638],"TT":[9.8732106,-62.083056,11.5628372,-60.2895848],"TV":[-9.9939389,175.1590468,-5.4369611,178.7344938],"TW":[10.374269,114.3599058,26.4372222,122.297],"TZ":[-11.761254,29.3269773,-0.9854812,40.6584071],"UA":[44.184598,22.137059,52.3791473,40.2275801],"UG":[-1.4823179,29.573433,4.2340766,35.000308],"UM":[6.1779744,-162.6816297,6.6514388,-162.1339885],"US":[24.9493,-125.0011,49.5904,-66.9326],"UY":[-35.7824481,-58.4948438,-30.0853962,-53.0755833],"UZ":[37.1821164,55.9977865,45.590118,73.1397362],"VA":[41.9002044,12.4457442,41.9073912,12.4583653],"VC":[12.5166548,-61.6657471,13.583,-60.9094146],"VE":[0.647529,-73.3529632,15.9158431,-59.5427079],"VG":[17.623468,-65.159094,18.464984,-64.512674],"VI":[17.623468,-65.159094,18.464984,-64.512674],"VN":[8.1790665,102.14441,23.393395,114.3337595],"VU":[-20.4627425,166.3355255,-12.8713777,170.449982],"WF":[-14.5630748,-178.3873749,-12.9827961,-175.9190391],"WS":[-14.2770916,-173.0091864,-13.2381892,-171.1929229],"XK":[41.855242,20.011597,43.269206,21.791382],"YE":[11.9084802,41.60825,19,54.7389375],"YT":[-13.0210119,45.0183298,-12.6365902,45.2999917],"ZA":[-47.1788335,16.3335213,-22.1250301,38.2898954],"ZM":[-18.0765945,21.9993509,-8.2712822,33.701111],"ZW":[-22.4241096,25.2373,-15.6097033,33.0683413]}

export const getPointsBounds = (geoPoints: GeoPoint[]): LngLatBounds|undefined => {
    const coords: [number, number][] = [];

    geoPoints.forEach(point => {
        coords.push([point.lng, point.lat]);
    })
    return createValidBounds(coords);
}

export const getCountriesBounds = (countries: Country[]): LngLatBounds => {
    const coords: [number, number][] = [];

    countries.forEach(country => {
        const countryCoords = bboxes[country];
        coords.push([countryCoords[1], countryCoords[0]]);
        coords.push([countryCoords[3], countryCoords[2]]);
    })
    const [minLng, minLat, maxLng, maxLat] = bbox(points(coords));
    return new LngLatBounds([minLng, minLat, maxLng, maxLat]);
}

export const getCountriesPoints = (countries: Country[]): GeoPoint[] => {
    const points: GeoPoint[] = [];

    countries.forEach(country => {
        const countryCoords = bboxes[country];
        points.push(new GeoPoint({lat: countryCoords[0], lng: countryCoords[1]}));
        points.push(new GeoPoint({lat: countryCoords[2], lng: countryCoords[3]}));
    })
    return points;
}

const createValidBounds = (coords: [number, number][]): LngLatBounds|undefined => {
    if (coords.length) {
        const [minLng, minLat, maxLng, maxLat] = bbox(points(coords));
        return new LngLatBounds([minLng, minLat, maxLng, maxLat]);
    }
    return undefined;
}